---
name: keepalived

description: "The keepalived job can be used to add a VRRP IP address to enforce HA on service-fabrik release"

packages:
- keepalived
- bosh-helpers
- aws-cli

templates:
  bin/keepalived_ctl.erb: 		bin/keepalived_ctl
  bin/action.sh.erb: 			bin/action.sh
  bin/notify.sh.erb: 			bin/notify.sh
  bin/get_keepalived_state.sh.erb: 	bin/get_keepalived_state.sh
  bin/get_sf_broker_status.sh.erb: 	bin/get_sf_broker_status.sh
  config/keepalived.conf.erb: 		config/keepalived.conf

provides:
- name: keepalived
  type: keepalived
  properties:
  - status_script

consumes:
- name: broker
  type: broker

properties:
  status_script:
    description: "Script to check current node is master or backup"
    default: "/var/vcap/jobs/keepalived/bin/get_keepalived_state.sh"
