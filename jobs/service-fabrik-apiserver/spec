---
name: service-fabrik-apiserver

packages:
- apiserver

templates:
  bin/ensure_apiserver_healthy.erb: bin/ensure_apiserver_healthy
  bin/post-start.erb: bin/post-start
  config/bpm.yml.erb: config/bpm.yml
  config/etcd-ca.crt.erb: config/etcd-ca.crt
  config/etcd.crt.erb: config/etcd.crt
  config/etcd.key.erb: config/etcd.key
  config/kubernetes-key.pem.erb: config/kubernetes-key.pem
  config/kubernetes.pem.erb: config/kubernetes.pem
  config/tokens.csv.erb: config/tokens.csv

provides:
- name: service-fabrik-apiserver
  type: service-fabrik-apiserver
  properties:
  - ip
  - port
  - etcd.url
  - etcd.ssl.ca
  - etcd.ssl.crt
  - etcd.ssl.key
  - admin-username
  - admin-password
  - tls.kubernetes.ca

properties:
  logging-level:
    description: "V-leveled logging at the specified level. See https://github.com/golang/glog"
    default: 2
  admin-username:
    description: The admin username for the Kubernetes cluster
  admin-password:
    description: The password for the admin account
  kube-controller-manager-password:
    description: The password for the system:kube-controller-manager user
  kubelet-password:
    description: The password for the kubelet user
  kubelet-drain-password:
    description: The password for the kubelet drain user
  kube-proxy-password:
    description: The password for the kube-proxy user
  kube-scheduler-password:
    description: The password for the system:kube-scheduler user
  route-sync-password:
    description: The password for the route-sync user
  tls.kubernetes.ca:
    description: "CA Certificate for the Kubernetes master"
  tls.kubernetes.certificate:
    description: "Certificate for the Kubernetes master"
  tls.kubernetes.private_key:
    description: "Private key for the Kubernetes master"
  ip:
    description: IP address used for apiserver
  port:
    description: Port used for apiserver
    default: 9443
  etcd.url:
    description: ETCD host URL to connect
  etcd.ssl.ca:
    description: CA for etcd client and server authentication
  etcd.ssl.crt:
    description: Certificate for etcd client and server authentication
  etcd.ssl.key:
    description: Private key for etcd client and server authentication


consumes:
- name: service-fabrik-apiserver
  type: service-fabrik-apiserver
